/* esm.sh - esbuild bundle(css-what@6.1.0) deno production */
var e;(function(a){a.Attribute="attribute",a.Pseudo="pseudo",a.PseudoElement="pseudo-element",a.Tag="tag",a.Universal="universal",a.Adjacent="adjacent",a.Child="child",a.Descendant="descendant",a.Parent="parent",a.Sibling="sibling",a.ColumnCombinator="column-combinator"})(e||(e={}));var X={Unknown:null,QuirksMode:"quirks",IgnoreCase:!0,CaseSensitive:!1},u;(function(a){a.Any="any",a.Element="element",a.End="end",a.Equals="equals",a.Exists="exists",a.Hyphen="hyphen",a.Not="not",a.Start="start"})(u||(u={}));var N=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,L=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,z=new Map([[126,u.Element],[94,u.Start],[36,u.End],[42,u.Any],[33,u.Not],[124,u.Hyphen]]),O=new Set(["has","not","matches","is","where","host","host-context"]);function j(a){switch(a.type){case e.Adjacent:case e.Child:case e.Descendant:case e.Parent:case e.Sibling:case e.ColumnCombinator:return!0;default:return!1}}var _=new Set(["contains","icontains"]);function B(a,n,t){let i=parseInt(n,16)-65536;return i!==i||t?n:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,i&1023|56320)}function d(a){return a.replace(L,B)}function b(a){return a===39||a===34}function D(a){return a===32||a===9||a===10||a===12||a===13}function G(a){let n=[],t=V(n,`${a}`,0);if(t<a.length)throw new Error(`Unmatched selector: ${a.slice(t)}`);return n}function V(a,n,t){let i=[];function c(h){let r=n.slice(t+h).match(N);if(!r)throw new Error(`Expected name, found ${n.slice(t)}`);let[s]=r;return t+=h+s.length,d(s)}function f(h){for(t+=h;t<n.length&&D(n.charCodeAt(t));)t++}function $(){t+=1;let h=t,r=1;for(;r>0&&t<n.length;t++)n.charCodeAt(t)===40&&!l(t)?r++:n.charCodeAt(t)===41&&!l(t)&&r--;if(r)throw new Error("Parenthesis not matched");return d(n.slice(h,t-1))}function l(h){let r=0;for(;n.charCodeAt(--h)===92;)r++;return(r&1)===1}function v(){if(i.length>0&&j(i[i.length-1]))throw new Error("Did not expect successive traversals.")}function g(h){if(i.length>0&&i[i.length-1].type===e.Descendant){i[i.length-1].type=h;return}v(),i.push({type:h})}function y(h,r){i.push({type:e.Attribute,name:h,action:r,value:c(1),namespace:null,ignoreCase:"quirks"})}function P(){if(i.length&&i[i.length-1].type===e.Descendant&&i.pop(),i.length===0)throw new Error("Empty sub-selector");a.push(i)}if(f(0),n.length===t)return t;a:for(;t<n.length;){let h=n.charCodeAt(t);switch(h){case 32:case 9:case 10:case 12:case 13:{(i.length===0||i[0].type!==e.Descendant)&&(v(),i.push({type:e.Descendant})),f(1);break}case 62:{g(e.Child),f(1);break}case 60:{g(e.Parent),f(1);break}case 126:{g(e.Sibling),f(1);break}case 43:{g(e.Adjacent),f(1);break}case 46:{y("class",u.Element);break}case 35:{y("id",u.Equals);break}case 91:{f(1);let r,s=null;n.charCodeAt(t)===124?r=c(1):n.startsWith("*|",t)?(s="*",r=c(2)):(r=c(0),n.charCodeAt(t)===124&&n.charCodeAt(t+1)!==61&&(s=r,r=c(1))),f(0);let o=u.Exists,S=z.get(n.charCodeAt(t));if(S){if(o=S,n.charCodeAt(t+1)!==61)throw new Error("Expected `=`");f(2)}else n.charCodeAt(t)===61&&(o=u.Equals,f(1));let A="",E=null;if(o!=="exists"){if(b(n.charCodeAt(t))){let w=n.charCodeAt(t),m=t+1;for(;m<n.length&&(n.charCodeAt(m)!==w||l(m));)m+=1;if(n.charCodeAt(m)!==w)throw new Error("Attribute value didn't end");A=d(n.slice(t+1,m)),t=m+1}else{let w=t;for(;t<n.length&&(!D(n.charCodeAt(t))&&n.charCodeAt(t)!==93||l(t));)t+=1;A=d(n.slice(w,t))}f(0);let q=n.charCodeAt(t)|32;q===115?(E=!1,f(1)):q===105&&(E=!0,f(1))}if(n.charCodeAt(t)!==93)throw new Error("Attribute selector didn't terminate");t+=1;let Q={type:e.Attribute,name:r,action:o,value:A,namespace:s,ignoreCase:E};i.push(Q);break}case 58:{if(n.charCodeAt(t+1)===58){i.push({type:e.PseudoElement,name:c(2).toLowerCase(),data:n.charCodeAt(t)===40?$():null});continue}let r=c(1).toLowerCase(),s=null;if(n.charCodeAt(t)===40)if(O.has(r)){if(b(n.charCodeAt(t+1)))throw new Error(`Pseudo-selector ${r} cannot be quoted`);if(s=[],t=V(s,n,t+1),n.charCodeAt(t)!==41)throw new Error(`Missing closing parenthesis in :${r} (${n})`);t+=1}else{if(s=$(),_.has(r)){let o=s.charCodeAt(0);o===s.charCodeAt(s.length-1)&&b(o)&&(s=s.slice(1,-1))}s=d(s)}i.push({type:e.Pseudo,name:r,data:s});break}case 44:{P(),i=[],f(1);break}default:{if(n.startsWith("/*",t)){let o=n.indexOf("*/",t+2);if(o<0)throw new Error("Comment was not terminated");t=o+2,i.length===0&&f(0);break}let r=null,s;if(h===42)t+=1,s="*";else if(h===124){if(s="",n.charCodeAt(t+1)===124){g(e.ColumnCombinator),f(2);break}}else if(N.test(n.slice(t)))s=c(0);else break a;n.charCodeAt(t)===124&&n.charCodeAt(t+1)!==124&&(r=s,n.charCodeAt(t+1)===42?(s="*",t+=2):s=c(1)),i.push(s==="*"?{type:e.Universal,namespace:r}:{type:e.Tag,name:s,namespace:r})}}}return P(),t}var U=["\\",'"'],W=[...U,"(",")"],J=new Set(U.map(a=>a.charCodeAt(0))),F=new Set(W.map(a=>a.charCodeAt(0))),C=new Set([...W,"~","^","$","*","+","!","|",":","[","]"," ","."].map(a=>a.charCodeAt(0)));function M(a){return a.map(n=>n.map(K).join("")).join(", ")}function K(a,n,t){switch(a.type){case e.Child:return n===0?"> ":" > ";case e.Parent:return n===0?"< ":" < ";case e.Sibling:return n===0?"~ ":" ~ ";case e.Adjacent:return n===0?"+ ":" + ";case e.Descendant:return" ";case e.ColumnCombinator:return n===0?"|| ":" || ";case e.Universal:return a.namespace==="*"&&n+1<t.length&&"name"in t[n+1]?"":`${H(a.namespace)}*`;case e.Tag:return T(a);case e.PseudoElement:return`::${p(a.name,C)}${a.data===null?"":`(${p(a.data,F)})`}`;case e.Pseudo:return`:${p(a.name,C)}${a.data===null?"":`(${typeof a.data=="string"?p(a.data,F):M(a.data)})`}`;case e.Attribute:{if(a.name==="id"&&a.action===u.Equals&&a.ignoreCase==="quirks"&&!a.namespace)return`#${p(a.value,C)}`;if(a.name==="class"&&a.action===u.Element&&a.ignoreCase==="quirks"&&!a.namespace)return`.${p(a.value,C)}`;let i=T(a);return a.action===u.Exists?`[${i}]`:`[${i}${R(a.action)}="${p(a.value,J)}"${a.ignoreCase===null?"":a.ignoreCase?" i":" s"}]`}}}function R(a){switch(a){case u.Equals:return"";case u.Element:return"~";case u.Start:return"^";case u.End:return"$";case u.Any:return"*";case u.Not:return"!";case u.Hyphen:return"|";case u.Exists:throw new Error("Shouldn't be here")}}function T(a){return`${H(a.namespace)}${p(a.name,C)}`}function H(a){return a!==null?`${a==="*"?"*":p(a,C)}|`:""}function p(a,n){let t=0,i="";for(let c=0;c<a.length;c++)n.has(a.charCodeAt(c))&&(i+=`${a.slice(t,c)}\\${a.charAt(c)}`,t=c+1);return i.length>0?i+a.slice(t):a}export{u as AttributeAction,X as IgnoreCaseMode,e as SelectorType,j as isTraversal,G as parse,M as stringify};
